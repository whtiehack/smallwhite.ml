<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><title>luaplus 与官方文档慢慢扯(七) | smallwhite's Blog</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="slog, smallwhite's blog, 后端博客, 后端, 程序员, 后端开发, 全栈开发, node.js, javascript, golang, c/c++, pinus, pomelo, typescript"><meta name="description" content="smallwhite's Blog 日常学习与兴趣交流的个人博客"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="https://smallwhite.ml/pub/uncategorized/luaplus-yu-guan-fang-wen-dang-man-man-che-qi.html"><link rel="icon" type="image/png" href="/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="smallwhite's Blog"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ffbfeacabe5e673d7a972c8b3977806f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="smallwhite's Blog" alt="smallwhite's Blog"><img src="/favicon.png" alt="smallwhite's Blog"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/bookmark" alt="书签" title="书签">书签</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><header class="post__info"><h1 class="post__title">luaplus 与官方文档慢慢扯(七)</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/">undefined</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2011-05-08</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/CSDN迁移/">CSDN迁移</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>次</li></ul></div></div></header><div class="post__content"><h2 id="Class-LuaTableIterator-lua-table-迭代类"><a href="#Class-LuaTableIterator-lua-table-迭代类" class="headerlink" title="Class: LuaTableIterator(lua table 迭代类 )"></a>Class: LuaTableIterator(lua table 迭代类 )</h2><p>LuaPlus 提供了一个名为 LuaTableIterator 的类</p><p>他的作用是让我们在c++内遍历lua table时比使用标准lua CAPI更简单 方便 也更安全</p><p>(The iterator is not STL compliant in its current form.)</p><p>使用起来真的非常简单</p><p>LuaStateOwner state; state-&gt;DoString( “MyTable = { Hi = 5, Hello = 10, Yo = 6 }” ); LuaObject obj = state-&gt;GetGlobals()[ “MyTable” ]; for ( LuaTableIterator it( obj ); it; it.Next() ) { const char* key = it.GetKey().GetString(); int num = it.GetValue().GetInteger(); printf(“%s=%d/n”,key,num); } // Hello=10 // Hi=5 // Yo=6</p><h2 id="Class-LuaStackObject"><a href="#Class-LuaStackObject" class="headerlink" title="Class: LuaStackObject"></a>Class: LuaStackObject</h2><hr><p>LuaPlus does not use integers to represent stack objects. Instead, those stack indices are wrapped in a <code>LuaStackObject</code> . <code>LuaStackObjects</code> can be passed directly to a Lua C function, if needed, but it is advised to go through the LuaPlus version of the function.</p><p>Using a <code>LuaObject</code> is usually the better way to go, since a <code>LuaObject</code> relieves the user of any stack management at all. <code>LuaStackObjects</code> are available for use in callback functions or in special case stack management scenarios.</p><p><code>LuaStackObjects</code> also store a pointer to the parent <code>LuaState</code> . In part, this is what makes the <em>LuaWatchAddin</em> work. Most importantly, <code>LuaStackObjects</code> can just be passed around without any regard for the <code>LuaState</code> they came from.</p><p>Most <code>LuaStackObject</code> functions mirror <code>LuaObject</code> functions of the same name, so see the section above for more detail.</p><ul><li>Push()/Pop().</li></ul><hr><h2 id="Class-LuaRefObject"><a href="#Class-LuaRefObject" class="headerlink" title="Class: LuaRefObject"></a>Class: LuaRefObject</h2><p>(使用了LuaObject类 没有必要再使用这个类了)</p><hr><p>LuaPlus enhances the Lua ref table facility by allowing ref’ed objects to be used without using <code>GetRef()</code> to push them onto the stack. <code>LuaRefObject</code> encapsulates this new functionality. Assigning a <code>LuaObject</code> (or another <code>LuaRefObject</code> ) to a <code>LuaRefObject</code> instance will cause a <code>lua_ref()</code> to occur. When the <code>LuaRefObject</code> goes out of scope, <code>lua_unref()</code> is called. <code>LuaRefObject</code> is derived from <code>LuaObject</code> and can operate on ref’ed objects without issue.</p><p>The <em>LuaWatchAddin</em> displays the contents of <code>LuaRefObjects</code> .</p><hr><hr><h2 id="Class-LuaStackTableIterator"><a href="#Class-LuaStackTableIterator" class="headerlink" title="Class: LuaStackTableIterator"></a>Class: LuaStackTableIterator</h2><p>A <code>LuaStackTableIterator</code> is almost identical to the <code>LuaTableIterator</code> above, except it provides support for iterating using the stack, similar to how core Lua does it.</p><p><code>LuaStackTableIterator</code> is fully documented in <code>LuaPlus.h</code> .</p><hr><h2 id="Class-LuaAutoBlock-使用了-LuaObject-同样没有必要再使用此类"><a href="#Class-LuaAutoBlock-使用了-LuaObject-同样没有必要再使用此类" class="headerlink" title="Class: LuaAutoBlock(使用了 LuaObject 同样没有必要再使用此类)"></a>Class: LuaAutoBlock(使用了 LuaObject 同样没有必要再使用此类)</h2><p>也就是很少使用到这个类 不过如果涉及到 堆栈操作 最好使用此类保护堆栈</p><p>Nothing can be more frustrating than paying attention to stack management. Which function allocates which entry on the stack? How many entries? Did it get popped? Where is that stack leak at? <code>LuaAutoBlock</code> serves as a fairly useful approach to solving these problems.</p><p><code>LuaAutoBlock</code> is a C++ class whose constructor stores the index of the stack top. At destruction time, it sets the stack top to the stored index. By providing this functionality as an object, the stack is guaranteed to be restored, regardless of exit points from a function or loop block.</p><p><em>Note: When using the LuaObject class, there is no need to worry about stack management, and so LuaAutoBlock provides no benefits in that situation.</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; LuaAutoBlock autoBlock(state); LuaStackObject testObj = state-&gt;GetGlobals_Stack()[&quot;Test&quot;]; // Does this allocate a stack item? state-&gt;PushString[&quot;A string&quot;]; // Does this? testObj.SetNumber(&quot;Value&quot;, 5); // Does this? // Who cares? LuaAutoBlock automatically cleans it up. &#125;</span><br></pre></td></tr></table></figure><h2 id="Class-LuaStateOutFile"><a href="#Class-LuaStateOutFile" class="headerlink" title="Class: LuaStateOutFile"></a>Class: LuaStateOutFile</h2><p><code>LuaStateOutFile</code> and derived classes are used in conjunction with <code>LuaState::DumpObject()</code> . When a <code>LuaStateOutFile</code> object is passed to <code>DumpObject()</code> , that object is used for writing the Lua dump file. The application can derive from <code>LuaStateOutFile</code> to change the default dumping behavior.</p><h2 id="Namespace-LuaPlus-LuaHelper"><a href="#Namespace-LuaPlus-LuaHelper" class="headerlink" title="Namespace: LuaPlus::LuaHelper"></a>Namespace: LuaPlus::LuaHelper</h2><p>The LuaHelper namespace contains some useful helper functions for retrieving values from LuaObjects. The helper functions perform a lookup into a table for a certain key. If the key is required to be found and is not present, an assertion is triggered. Otherwise, the found value or a default value is returned.</p><p>The following helper functions are available:</p><ul><li><code>GetBoolean()</code></li><li><code>GetFloat()</code></li><li><code>GetLightUserData()</code></li><li><code>GetString()</code></li><li><code>GetTable()</code></li></ul><div class="post-announce">感谢您的阅读，本文由 <a href="https://smallwhite.ml">smallwhite's Blog</a> 版权所有。如若转载，请注明出处：smallwhite's Blog（<a href="https://smallwhite.ml/pub/uncategorized/luaplus-yu-guan-fang-wen-dang-man-man-che-qi.html">https://smallwhite.ml/pub/uncategorized/luaplus-yu-guan-fang-wen-dang-man-man-che-qi.html</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/pub/uncategorized/visual-c-6.0-bian-xi-te-bie-ban.by.cntrump-2011.02.12.html" title="Visual C++ 6.0 便携特别版.by.cntrump 2011.02.12"><i class="iconfont icon-prev"></i>Visual C++ 6.0 便携特别版.by.cntrump 2011.02.12</a></div><div class="post__prev post__prev--right"><a href="/pub/uncategorized/luaplus-yu-guan-fang-wen-dang-man-man-che-liu.html" title="luaplus 与官方文档慢慢扯(六)">luaplus 与官方文档慢慢扯(六)<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">smallwhite's Blog 日常学习与兴趣交流的个人博客</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/win32/">win32</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/pinus/">pinus</a><span class="block-list-count">2</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/nodejs/">nodejs</a><span class="block-list-count">2</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/linux/">linux</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/jenkins/">jenkins</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/ide/">ide</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/http2/">http2</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/go/">go</a><span class="block-list-count">2</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/docker/">docker</a><span class="block-list-count">1</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/pub/http2/golang-http-403-forbidden-disable-http2.html" title="golang http请求返回403 Forbidden - 禁用http2解决"><div class="item__cover"><img src="/programming.png" alt="golang http请求返回403 Forbidden - 禁用http2解决"></div><div class="item__info"><h3 class="item__title">golang http请求返回403 Forbidden - 禁用http2解决</h3><span class="item__text">2020-11-17</span></div></a></li><li class="latest-post-item"><a href="/pub/linux/convert-ssh-key-format-rsa-openssh.html" title="转换key格式OPENSSH PRIVATE KEY 转换为 RSA PRIVATE KEY"><div class="item__cover"><img src="/programming.png" alt="转换key格式OPENSSH PRIVATE KEY 转换为 RSA PRIVATE KEY"></div><div class="item__info"><h3 class="item__title">转换key格式OPENSSH PRIVATE KEY 转换为 RSA PRIVATE KEY</h3><span class="item__text">2020-11-07</span></div></a></li><li class="latest-post-item"><a href="/pub/jenkins/install-jenkins-use-mirrors.html" title="使用镜像安装jenkins"><div class="item__cover"><img src="/programming.png" alt="使用镜像安装jenkins"></div><div class="item__info"><h3 class="item__title">使用镜像安装jenkins</h3><span class="item__text">2020-04-03</span></div></a></li><li class="latest-post-item"><a href="/pub/nodejs/compare-go-nodejs-csharp.html" title="go c nodejs csharp 可能不太准确的性能测试"><div class="item__cover"><img src="/programming.png" alt="go c nodejs csharp 可能不太准确的性能测试"></div><div class="item__info"><h3 class="item__title">go c nodejs csharp 可能不太准确的性能测试</h3><span class="item__text">2019-11-15</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/CSDN迁移/">CSDN迁移</a></li><li class="tag-item"><a class="tag-link" href="/tags/c/">c++</a></li><li class="tag-item"><a class="tag-link" href="/tags/csharp/">csharp</a></li><li class="tag-item"><a class="tag-link" href="/tags/docker/">docker</a></li><li class="tag-item"><a class="tag-link" href="/tags/go/">go</a></li><li class="tag-item"><a class="tag-link" href="/tags/golang/">golang</a></li><li class="tag-item"><a class="tag-link" href="/tags/http2/">http2</a></li><li class="tag-item"><a class="tag-link" href="/tags/idea/">idea</a></li><li class="tag-item"><a class="tag-link" href="/tags/javascript/">javascript</a></li><li class="tag-item"><a class="tag-link" href="/tags/jenkins/">jenkins</a></li><li class="tag-item"><a class="tag-link" href="/tags/jetbrains/">jetbrains</a></li><li class="tag-item"><a class="tag-link" href="/tags/license/">license</a></li><li class="tag-item"><a class="tag-link" href="/tags/linux/">linux</a></li><li class="tag-item"><a class="tag-link" href="/tags/mirrors/">mirrors</a></li><li class="tag-item"><a class="tag-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-item"><a class="tag-link" href="/tags/pinus/">pinus</a></li><li class="tag-item"><a class="tag-link" href="/tags/pomelo/">pomelo</a></li><li class="tag-item"><a class="tag-link" href="/tags/proxy/">proxy</a></li><li class="tag-item"><a class="tag-link" href="/tags/win32/">win32</a></li><li class="tag-item"><a class="tag-link" href="/tags/windows/">windows</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text"></p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>https://github.com/whtiehack</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>smallwhite110@gmail.com</span></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">友情链接</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://github.com/whtiehack" title="smallwhite's Github" target="_blank">Github</a></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">构建工具</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://hexo.io/" title="Blog Framework" target="_blank">Hexo</a></li><li class="list-item"><a href="https://github.com/Mrminfive/hexo-theme-skapp" title="Blog theme" target="_blank">Theme</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="/" target="_blank">smallwhite</a> 2019 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="/" target="_blank">smallwhite</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/whtiehack" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:smallwhite110@gmail.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["CSDN迁移"],gitalk=new Gitalk({clientID:"afe80ed401fed3bea37a",clientSecret:"e9d739d3b614ac49d15e8e64dc9006c2c14baa02",repo:"smallwhite.ml",owner:"whtiehack",admin:["whtiehack"],labels:tags,id:new Date(130479654e4).toISOString()});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>